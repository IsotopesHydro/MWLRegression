geom_abline(data = reg_lines, aes(intercept = intercept, slope = slope, color = line), linewidth = 0.5) +
scale_color_manual(values = c("red", "blue")) +
labs(color = "Regression Lines", x = "Xi", y = "Yi")
df3=data.frame(X=rchisq(1:100000, df=length(Xi)-2))
p2 <- ggplot(df3,aes(x=X,y=after_stat(density))) + geom_density(fill='blue') +
geom_vline(aes(xintercept= S), col = "red")
print(p1)
print(p2)
}
res <- list(b,a,xi,yi,Xi-xi,Yi-yi,sqrt(Sb2),sqrt(Sa2),S,pX2,length(Xi)-2, bVect) # results to return
names(res) <- c("York Slope", "York Intercept", "Expected Xi", "Expected Yi", "X-residuals", "Y-residuals", "Slope error", "Intercept error", "SSWR", "X2-probability", "df", "Iterated slope values")
return(res)
}
gc()
## SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 17, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df", "bOLS", "aOLS", "R2both", "MAEall",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa")
set.seed(NULL)
i=i
i=1
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)
####### CASE 4
### SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,17)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(1,2,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(1,2,14,15,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$roupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
library(smatr)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,17)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(1,2,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(1,2,14,15,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$roupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,17)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(1,2,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(1,2,14,15,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$groupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
write.table(testMX, file = "G:/Il mio Drive/MWLs_EMS_&_Paper/Script/OUT_Synt_24/OUTsynt_case4_plusSMAMA_sdVAR_allMAE.txt")
####### CASE 4
### SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,17)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$groupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
write.table(testMX, file = "G:/Il mio Drive/MWLs_EMS_&_Paper/Script/OUT_Synt_24/OUTsynt_case4_plusSMAMA_sdVAR_allMAE.txt")
warnings()
d2H
sd_2H
YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)
YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)
sma(d2H~d18O)
as.numeric(smalm$groupsummary[1,c(5,8)])
unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
####### CASE 4
### SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,17)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$groupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
warnings()
####### CASE 4
### SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,17)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(2,3,14,15,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$groupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
write.table(testMX, file = "G:/Il mio Drive/MWLs_EMS_&_Paper/Script/OUT_Synt_24/OUTsynt_case4_plusSMAMA_sdVAR_allMAE.txt")
YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)
####### CASE 4
### SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,18)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(2,3,14,15,16,11)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(2,3,14,15,11)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$groupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
write.table(testMX, file = "G:/Il mio Drive/MWLs_EMS_&_Paper/Script/OUT_Synt_24/OUTsynt_case4_plusSMAMA_sdVAR_allMAE.txt")
?mean()
####### CASE 4
### SYNT DATA
n <- 24
time <- 1:n
trend_m <- 0
s_max <- -2
s_min <- -15
noise_m <- 0
noise_sd <- 0
seasonal_shift <- -1
# Set seed for reproducibility
set.seed(123)
d18O <- TS_gen(n, trend_m, s_max, s_min, noise_m, noise_sd, seasonal_shift)
d18Oabs <- d18O
iso_m <- 8
iso_q <- 10
d2Habs <- iso_m * d18Oabs + iso_q
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
# sd_18O <- 0.1
# sd_2H <- 1
#
# set.seed(42)
# err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
# set.seed(22)
# err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
# err_d18O[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_18O*3)
# err_d2H[c(3,4,5,14,15,16,17,19)] <- rnorm(8, mean = 0, sd = sd_2H*3)
testMX <- as.data.frame(matrix(data = NA, nrow = 1000, ncol = 21, ))
colnames(testMX) <- c("bYrok", "aYork", "S", "pX2", "df",
"bOLS", "aOLS", "R2both",  "MAEall_OLS",
"bYrokDumb", "aYorkDumb", "SDumb", "pX2Dumb",
"smab", "smaa",
"mab", "maa",
"MAEYork", "MAEYorkDumb", "MAEsma", "MAEma" )
set.seed(NULL)
for(i in 1:1000){
sd_18O <- runif(n, min = 0.05, max = 1)
sd_2H <- runif(n, min = 0.5, max = 10)
err_d18O <- rnorm(n, mean = 0, sd = sd_18O)
err_d2H <- rnorm(n, mean = 0, sd = sd_2H)
d18O <- d18Oabs + err_d18O
d2H <- d2Habs + err_d2H
testMX[i, c(1:5,18)] <- unlist(YorkRegression(d18O, d2H, sd_18O, sd_2H,
iter = 100, plot = F)[c(2,3,14,15,16,10)], # here insert regression parameter
use.names = F)
OLS <- lm(d2H ~ d18O)
testMX[i,c(6)] <- as.numeric(summary(OLS)$coefficients[c(2),1])
testMX[i,c(7)] <- as.numeric(summary(OLS)$coefficients[c(1),1])
testMX[i,8] <- summary(OLS)$r.squared
testMX[i,9] <-mean(abs(summary(OLS)$residuals))
testMX[i, c(10:13,19)] <- unlist(YorkRegression(d18O, d2H, rep(0.1,n), rep(1,n),
iter = 100, plot = F)[c(2,3,14,15,10)], # here insert regression parameter
use.names = F)
smalm <- sma(d2H~d18O)
testMX[i,c(14,15)] <- as.numeric(smalm$groupsummary[1,c(5,8)])
testMX[i,c(20)] <- mean(abs(residuals(smalm)))
malm <-  sma(d2H~d18O, method = c("MA"))
testMX[i,c(16,17)] <- as.numeric(malm$groupsummary[1,c(5,8)])
testMX[i,c(21)] <- mean(abs(residuals(malm)))
}
write.table(testMX, file = "G:/Il mio Drive/MWLs_EMS_&_Paper/Script/OUT_Synt_24/OUTsynt_case4_plusSMAMA_sdVAR_allMAE.txt")
setwd("G:/Il mio Drive/MWLs_EMS_&_Paper/Script/ForPublication/MWLRegression/")
devtools::document()
detach(MWLRegression)
detach("MWLRegression")
remove.packages("MWLRegression")
devtools::install_github("IsotopesHydro/MWLRegression")
